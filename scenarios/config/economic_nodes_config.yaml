# Economic Node Configuration
# Defines ideology profiles for economic (exchange) and user nodes
#
# Economic nodes "vote with their feet" by choosing which fork's economy
# to participate in. Their aggregate choices determine v27_economic_pct
# dynamically, feeding back into the price oracle.
#
# Fields:
#   fork_preference: 'v27', 'v26', or 'neutral'
#   ideology_strength: How much price disadvantage they'll accept (0.0-1.0)
#       0.0 = purely rational (always follow price)
#       1.0 = ideology at any cost
#   switching_threshold: Min price advantage % to switch forks (0.0-1.0)
#   inertia: Additional resistance to switching (0.0-1.0)
#       Effective threshold = switching_threshold + inertia
#   switching_cooldown: Seconds between allowed re-evaluations
#   max_loss_pct: Max price disadvantage % to maintain ideology (0.0-1.0)

# ============================================================================
# SCENARIO 1: Realistic Current Distribution
# ============================================================================
realistic_current:
  description: "Exchanges mostly rational, users more ideological"

  # Defaults applied to economic nodes (exchanges, payment processors)
  economic_defaults:
    fork_preference: "neutral"
    ideology_strength: 0.1
    switching_threshold: 0.03      # Need 3% price advantage to consider switching
    inertia: 0.15                   # High inertia (infrastructure costs)
    switching_cooldown: 1800        # 30 minutes between decisions
    max_loss_pct: 0.05              # Max 5% price disadvantage for ideology

  # Defaults applied to user/network nodes
  user_defaults:
    fork_preference: "neutral"
    ideology_strength: 0.3          # Users are more ideological than exchanges
    switching_threshold: 0.08       # Users are slower to switch
    inertia: 0.05                   # But lower inertia (just wallet/app choice)
    switching_cooldown: 3600        # 1 hour between decisions
    max_loss_pct: 0.15              # Users tolerate more loss for beliefs

  # Per-role overrides (applied on top of economic_defaults)
  overrides:
    # Major exchanges: purely rational, high inertia
    major_exchange:
      fork_preference: "neutral"
      ideology_strength: 0.0
      switching_threshold: 0.02     # Very responsive to price signals
      inertia: 0.20                 # But high switching costs

    # Regular exchanges
    exchange:
      fork_preference: "neutral"
      ideology_strength: 0.05
      switching_threshold: 0.03
      inertia: 0.15

    # Payment processors: slightly favor stability (v26)
    payment_processor:
      fork_preference: "v26"
      ideology_strength: 0.2
      switching_threshold: 0.05
      inertia: 0.10

# ============================================================================
# SCENARIO 2: Ideological Split
# ============================================================================
ideological_split:
  description: "Strong ideological division among all participants"

  economic_defaults:
    switching_threshold: 0.05
    inertia: 0.10
    switching_cooldown: 1200        # 20 minutes (faster decisions during conflict)
    max_loss_pct: 0.20

  user_defaults:
    switching_threshold: 0.10
    inertia: 0.03
    switching_cooldown: 1800
    max_loss_pct: 0.30

  overrides:
    major_exchange:
      fork_preference: "neutral"
      ideology_strength: 0.1        # Even big exchanges take a side slightly
      inertia: 0.15

  # Distribution pattern: assign ideology based on proportion of nodes
  # Nodes are assigned to buckets by index position
  distribution_pattern:
    economic:
      - pct: 40
        fork_preference: "v27"
        ideology_strength: 0.7
      - pct: 40
        fork_preference: "v26"
        ideology_strength: 0.7
      - pct: 20
        fork_preference: "neutral"
        ideology_strength: 0.0
    user:
      - pct: 50
        fork_preference: "v27"
        ideology_strength: 0.8
      - pct: 30
        fork_preference: "v26"
        ideology_strength: 0.6
      - pct: 20
        fork_preference: "neutral"
        ideology_strength: 0.1

# ============================================================================
# SCENARIO 3: Purely Rational (baseline)
# ============================================================================
purely_rational:
  description: "All economic actors purely rational (no ideology)"

  economic_defaults:
    fork_preference: "neutral"
    ideology_strength: 0.0
    switching_threshold: 0.02
    inertia: 0.05
    switching_cooldown: 600         # 10 minutes
    max_loss_pct: 0.0

  user_defaults:
    fork_preference: "neutral"
    ideology_strength: 0.0
    switching_threshold: 0.05
    inertia: 0.02
    switching_cooldown: 600
    max_loss_pct: 0.0

# ============================================================================
# SCENARIO 4: Strong v26 Resistance
# ============================================================================
strong_v26_resistance:
  description: "Significant economic resistance to v27 upgrade"

  economic_defaults:
    fork_preference: "v26"
    ideology_strength: 0.5
    switching_threshold: 0.08
    inertia: 0.15
    switching_cooldown: 1800
    max_loss_pct: 0.25

  user_defaults:
    fork_preference: "v26"
    ideology_strength: 0.6
    switching_threshold: 0.12
    inertia: 0.05
    switching_cooldown: 3600
    max_loss_pct: 0.30

  overrides:
    major_exchange:
      fork_preference: "neutral"    # Major exchanges stay neutral even in resistance
      ideology_strength: 0.1
      switching_threshold: 0.03
      inertia: 0.20

# ============================================================================
# SCENARIO: Asymmetric Soft Fork - Balanced Battle
# ============================================================================
# Close economic split with moderate ideology
# Designed for oscillation and dynamic equilibrium
asymmetric_balanced:
  description: "Balanced battle - slight v27 economic edge vs v26 hashrate edge. Moderate ideology creates tension."

  economic_defaults:
    switching_threshold: 0.08      # 8% price diff triggers evaluation
    inertia: 0.10                  # Moderate inertia
    switching_cooldown: 900        # 15 min cooldown
    max_loss_pct: 0.12

  user_defaults:
    switching_threshold: 0.10
    inertia: 0.08
    switching_cooldown: 1200
    max_loss_pct: 0.15

  overrides:
    major_exchange:
      fork_preference: "neutral"
      ideology_strength: 0.15
      inertia: 0.05

  # Close split: v27=55%, v26=45% economic
  # Moderate ideology so switching is possible but not instant
  distribution_pattern:
    economic:
      - pct: 45
        fork_preference: "v27"
        ideology_strength: 0.4
      - pct: 35
        fork_preference: "v26"
        ideology_strength: 0.4
      - pct: 20
        fork_preference: "neutral"
        ideology_strength: 0.1
    user:
      - pct: 40
        fork_preference: "v27"
        ideology_strength: 0.35
      - pct: 35
        fork_preference: "v26"
        ideology_strength: 0.35
      - pct: 25
        fork_preference: "neutral"
        ideology_strength: 0.1

# ============================================================================
# SCENARIO: Asymmetric Soft Fork - Extreme Divergence
# ============================================================================
# Designed to trigger dynamic partition switching
# v27 starts with overwhelming economic support but minority hashrate
# Low ideology = nodes will switch based on economics
asymmetric_extreme:
  description: "Extreme price divergence scenario. v27 economic dominance vs v26 hashrate dominance. Low ideology for switching."

  economic_defaults:
    switching_threshold: 0.05      # Very sensitive - 5% price diff triggers evaluation
    inertia: 0.02                  # Low inertia - quick to switch
    switching_cooldown: 600        # 10 min cooldown
    max_loss_pct: 0.10

  user_defaults:
    switching_threshold: 0.08
    inertia: 0.03
    switching_cooldown: 900
    max_loss_pct: 0.15

  overrides:
    major_exchange:
      fork_preference: "neutral"   # Exchanges follow the money
      ideology_strength: 0.05
      inertia: 0.01

  # v27 gets 80% economic support initially (will create price premium)
  # v26 gets 20% (but has hashrate dominance)
  # Low ideology means nodes WILL switch if economics shift
  distribution_pattern:
    economic:
      - pct: 70
        fork_preference: "v27"
        ideology_strength: 0.2      # Low - will switch for profit
      - pct: 20
        fork_preference: "v26"
        ideology_strength: 0.2
      - pct: 10
        fork_preference: "neutral"
        ideology_strength: 0.0
    user:
      - pct: 60
        fork_preference: "v27"
        ideology_strength: 0.15
      - pct: 25
        fork_preference: "v26"
        ideology_strength: 0.15
      - pct: 15
        fork_preference: "neutral"
        ideology_strength: 0.0

# ============================================================================
# SCENARIO: Asymmetric Soft Fork (Non-Contentious)
# ============================================================================
# Matches asymmetric_softfork pool scenario
# v27 minority with moderate economic support
# v26 majority with dominant economic position
asymmetric_softfork:
  description: "Non-contentious soft fork economic distribution. v27 minority with committed supporters."

  economic_defaults:
    switching_threshold: 0.12
    inertia: 0.15
    switching_cooldown: 1200
    max_loss_pct: 0.25

  user_defaults:
    switching_threshold: 0.10
    inertia: 0.05
    switching_cooldown: 1800
    max_loss_pct: 0.15

  overrides:
    major_exchange:
      fork_preference: "neutral"
      ideology_strength: 0.2
      inertia: 0.20

  # v27 gets 40% economic support (minority but committed)
  # v26 gets 60% economic support (majority, less committed)
  distribution_pattern:
    economic:
      - pct: 35
        fork_preference: "v27"
        ideology_strength: 0.7
      - pct: 45
        fork_preference: "v26"
        ideology_strength: 0.5
      - pct: 20
        fork_preference: "neutral"
        ideology_strength: 0.1
    user:
      - pct: 30
        fork_preference: "v27"
        ideology_strength: 0.6
      - pct: 40
        fork_preference: "v26"
        ideology_strength: 0.4
      - pct: 30
        fork_preference: "neutral"
        ideology_strength: 0.2

# ============================================================================
# SCENARIO: Ideological Standoff
# ============================================================================
# Economic nodes are iron-locked 50/50 — they CANNOT switch forks under any
# realistic price divergence the model can produce.
#
# Math check:
#   Max price divergence (model cap) = 20%
#   switching_threshold (0.30) + inertia (0.30) = 0.60 effective threshold
#   0.60 >> 0.20 → economic nodes never evaluate a switch
#   Even if they did: max_loss_pct=0.50, ideology=0.9 → tolerance=45% >> 20%
#
# Effect: The 50/50 economic split is FROZEN throughout the simulation.
# This constrains the price oracle, preventing runaway cascade:
#   - With 50/50 econ locked, max price gap = ±20% (capped)
#   - Committed pool tolerance = 31.5% > 20% → also never switch
#   - Only neutral pools (38%) shift based on the constrained price signal
ideological_standoff:
  description: "50/50 economic iron-lock. Neither side switches under any realistic price divergence."

  economic_defaults:
    switching_threshold: 0.30      # Need 30% price advantage to trigger evaluation
    inertia: 0.30                  # Additional 30% resistance (effective threshold = 60%)
    switching_cooldown: 7200       # 2-hour cooldown (longer than any reasonable test)
    max_loss_pct: 0.50             # Would accept 50% loss before forced switch (never reached)

  user_defaults:
    switching_threshold: 0.25
    inertia: 0.20
    switching_cooldown: 7200
    max_loss_pct: 0.40

  overrides:
    major_exchange:
      fork_preference: "neutral"   # Major exchanges are neutral but also locked by inertia
      ideology_strength: 0.5
      inertia: 0.35

  # Exactly 50/50 split — no starting advantage for either fork
  # High ideology ensures nodes stay committed regardless of price
  distribution_pattern:
    economic:
      - pct: 50
        fork_preference: "v27"
        ideology_strength: 0.9
      - pct: 50
        fork_preference: "v26"
        ideology_strength: 0.9
    user:
      - pct: 50
        fork_preference: "v27"
        ideology_strength: 0.8
      - pct: 50
        fork_preference: "v26"
        ideology_strength: 0.8

# ============================================================================
# Model Parameters (apply to all scenarios)
# ============================================================================
model_parameters:
  decision_interval: 300            # Re-evaluate every 5 minutes
  economic_switching_cooldown: 1800 # Economic nodes: 30 min between switches
  user_switching_cooldown: 3600     # User nodes: 1 hour between switches
  initial_fork_assignment: "by_partition"  # Nodes start on their partition's fork
